#include<stdio.h>
#include<time.h>

void swap(int* a, int* b){
    int temp = *a;
    *a = *b;
    *b = temp;
}

int lomutoPartition(int* arr, int l, int r){
    int pivot = arr[l];
    int location = l;

    for (int i = l+1;i<=r;i++){
        if (arr[i] < pivot){
            location = location+1;
            swap(&(arr[i]),&(arr[location]));
        }
    }
    swap(&arr[l],&arr[location]);
    return location;
}

int hoarePartition(int*arr, int l, int r){
    int pivot = arr[l];
    int i = l;
    int j = r+1;
    while (i<j){
        do{
            i++;
        }while(i < r && arr[i]<=pivot);
        do{
            j--;
        }while (j >= l && arr[j] > pivot);
        if (i<j){
            swap(&arr[i],&arr[j]);
        }
    }
    swap(&arr[l], &arr[j]);
    return j;
}

int quickSelect(int* arr, int l,int r, int k, int sortMode){
    if (sortMode == 1){
        int pivotLocation = lomutoPartition(arr, l, r);
        if (pivotLocation == k-1){
            return arr[pivotLocation];
        }
        else if (pivotLocation > k-1){
            quickSelect(arr,l,pivotLocation-1,k,1);
        }
        else{
            quickSelect(arr,pivotLocation+1,r,k,1);
        }
    }
    else if (sortMode == 2){
        int pivotLocation = hoarePartition(arr, l, r);
        if (pivotLocation == k-1){
            return arr[pivotLocation];
        }
        else if (pivotLocation > k-1){
            quickSelect(arr,l,pivotLocation-1,k,2);
        }
        else{
            quickSelect(arr,pivotLocation+1,r,k,2);
        }
    }
    
}

int main(){
    clock_t startL, endL, startH, endH;
    int arr1[] = {2202, 5578, 405, 6153, 126, 5001, 2465, 196, 7427, 6927, 4545, 1330, 4814, 3238, 1119, 6258, 313, 4273, 414, 1238, 5680, 6099, 4752, 695, 5505, 6883, 934, 6132, 6324, 1188, 860, 6658, 3988, 441, 6429, 1144, 626, 1017, 5449, 1055, 7332, 210, 5160, 3550, 1890, 6501, 5462, 843, 838, 2705, 1415, 1756, 6270, 1913, 1291, 7115, 4997, 5703, 1705, 2800, 830, 4097, 6137, 6061, 4093, 1717, 7006, 908, 965, 7147, 4335, 5781, 7521, 6449, 5710, 6348, 4475, 7194, 4405, 2327, 3355, 2784, 1633, 2474, 181, 7252, 535, 2282, 5139, 2824, 7077, 1639, 6547, 2255, 5589, 717, 1435, 267, 6359, 3491, 5280, 995, 2079, 3724, 4932, 3925, 3317, 1171, 6712, 6604, 335, 3070, 5731, 6125, 62, 5034, 5487, 4490, 3356, 171, 5528, 3714, 4326, 2603, 2561, 130, 1303, 1186, 7131, 1659, 5638, 5006, 6796, 4549, 623, 1001, 3438, 1224, 2365, 5195, 1534, 4516, 2356, 6309, 876, 3147, 3134, 5230, 6181, 3866, 4985, 1816, 1685, 6829, 5438, 5974, 6808, 4631, 5705, 533, 5559, 1737, 4769, 6470, 4032, 5262, 6294, 5829, 3257, 5345, 4029, 6697, 1482, 640, 6123, 1230, 5210, 1293, 3856, 6322, 5632, 1023, 339, 4258, 6773, 660, 688, 2320, 1039, 5476, 2728, 4787, 4695, 6826, 3351, 5153, 548, 3733, 5027, 330, 1603, 6776, 3686, 503, 3541, 903, 4512, 6029, 5968, 2663, 5776, 3672, 4129, 981, 5939, 2384, 2448, 2160, 2012, 1483, 7527, 299, 2791, 222, 4552, 3665, 6261, 6466, 5404, 5078, 3617, 5964, 2199, 4773, 5595, 5387, 2082, 6143, 685, 5457, 4440, 1380, 1783, 4286, 1623, 4288, 5644, 4365, 5091, 1640, 3960, 639, 3998, 4355, 5683, 1733, 6920, 460, 6323, 854, 3464, 4287, 2385, 850, 6520, 5471, 7023, 4045, 3279, 6003, 263, 3595, 798, 4786, 861, 337, 7533, 492, 1569, 1009, 6710, 7423, 5654, 387, 3204, 3137, 5885, 756, 5970, 2843, 2213, 4232, 5800, 4390, 1707, 1179, 3403, 5530, 1759, 2687, 30, 57, 2763, 636, 651, 7334, 5323, 1878, 2493, 1340, 7523, 194, 6896, 5121, 2036, 2283, 6342, 1364, 7035, 3122, 2662, 7163, 6613, 2878, 2715, 3943, 5233, 6569, 4570, 1356, 513, 7089, 4238, 4763, 1990, 816, 3388, 465, 794, 6810, 6720, 4008, 7306, 435, 3308, 6733, 5026, 499, 4377, 2464, 2401, 4837, 5056, 3920, 4014, 7084, 6994, 324, 5947, 2495, 1060, 4499, 4804, 4649, 1219, 1541, 869, 2155, 2802, 5599, 1277, 4166, 309, 5062, 4996, 6791, 3383, 1604, 5773, 5248, 1994, 781, 3879, 1473, 7196, 3600, 2368, 3779, 5513, 6373, 1991, 353, 6755, 1472, 6249, 4560, 6664, 2860, 2722, 1871, 6735, 3681, 862, 1062, 1136, 3801, 6233, 4772, 386, 5059, 5173, 3221, 2340, 7493, 5794, 2884, 1341, 2335, 1063, 6483, 910, 3754, 1331, 6442, 6566, 6544, 7226, 7445, 43, 847, 5044, 2847, 3692, 261, 2567, 4344, 3357, 270, 6593, 3430, 6781, 1749, 864, 900, 192, 7062, 1384, 538, 6271, 3332, 6674, 1786, 4760, 5727, 6754, 6553, 17, 5294, 1629, 771, 1279, 1872, 7005, 5459, 3770, 3697, 612, 2110, 7027, 3893, 1800, 2584, 7118, 6606, 641, 2565, 5674, 649, 5217, 5851, 885, 4174, 4438, 341, 3362, 5347, 1050, 1785, 5562, 3458, 1388, 3591, 788, 6482, 397, 4546, 749, 1469, 1125, 7312, 2482, 7204, 2821, 6957, 243, 3660, 5053, 566, 4242, 1647, 6717, 4976, 91, 5598, 3605, 7037, 114, 3295, 4621, 5451, 4353, 5973, 5555, 5364, 5906, 5015, 7063, 5307, 5643, 7497, 2711, 6138, 1943, 5681, 262, 942, 3806, 2043, 6586, 6561, 1344, 4122, 5013, 1975, 7365, 6081, 3824, 1071, 4747, 2183, 1745, 6627, 4443, 2151, 5377, 6592, 2415, 2435, 4771, 4132, 1478, 5907, 1358, 6066, 3467, 6590, 2234, 783, 6418, 2249, 919, 3185, 939, 3614, 2372, 5780, 3716, 6035, 5052, 3493, 7485, 2529, 4551, 4564, 5235, 2849, 3032, 2175, 4249, 1590, 2911, 2286, 6000, 2288, 3756, 476, 7441, 1614, 2065, 6491, 4998, 5912, 4020, 2229, 1714, 2270, 6880, 2840, 3280, 1319, 997, 2004, 1398, 7057, 6101, 3781, 323, 3582, 3489, 3810, 5057, 182, 980, 583, 4984, 5863, 6898, 597, 4485, 690, 2400, 2783, 4157, 3065, 650, 6987, 5713, 4928, 7182, 1079, 3728, 3019, 4830, 2281, 4263, 1047, 5443, 3909, 3938, 144, 6330, 711, 3501, 950, 2296, 4178, 2235, 6331, 2460, 3506, 3429, 5045, 5066, 6083, 5741, 6459, 1906, 1772, 111, 5293, 5150, 404, 411, 4664, 3035, 4988, 3662, 5064, 4441, 3971, 1336, 5054, 4292, 3352, 5119, 7314, 5133, 3045, 868, 266, 5125, 1645, 4262, 1322, 5676, 2317, 6064, 5846, 2162, 5231, 5913, 1676, 6539, 6801, 4866, 5652, 2056, 1515, 246, 4311, 3642, 1945, 4931, 268, 6752, 6397, 5956, 518, 5817, 6516, 5030, 310, 1182, 3765, 456, 2228, 3311, 845, 4905, 5590, 5360, 1402, 5861, 7369, 2132, 145, 4962, 3063, 1455, 3166, 5267, 7105, 6876, 1139, 5319, 4670, 2075, 2343, 7250, 120, 6321, 2503, 7024, 1955, 4682, 5305, 750, 6545, 153, 7214, 7070, 3835, 5455, 3918, 5420, 2995, 5163, 6044, 5397, 3883, 3574, 675, 6882, 7388, 5630, 831, 5730, 6891, 694, 1527, 1984, 109, 4801, 3994, 3849, 2034, 1606, 321, 5324, 3066, 147, 3509, 5825, 2991, 5352, 4333, 865, 3108, 3062, 3006, 6305, 2370, 6836, 6287, 5648, 5613, 7141, 3175, 7452, 1873, 3903, 2537, 4562, 833, 4829, 2909, 3511, 1428, 4216, 2134, 925, 3915, 7340, 4596, 4349, 2409, 2430, 3233, 155, 3261, 4230, 7415, 5836, 5762, 6349, 1272, 4940, 6746, 2744, 3881, 4961, 6178, 2047, 6611, 5936, 7146, 3975, 6163, 6597, 1949, 3669, 2262, 3447, 7489, 1021, 5442, 3997, 4118, 3299, 6140, 3399, 4425, 3428, 2825, 3530, 4308, 886, 4789, 2499, 6091, 1971, 457, 2221, 2887, 4955, 5477, 2018, 1246, 4033, 4506, 6008, 7093, 7165, 2813, 7429, 6507, 458, 6948, 7110, 6148, 1690, 319, 1505, 7301, 401, 4616, 3473, 1389, 1183, 4316, 5141, 1826, 4872, 4399, 6643, 2006, 3807, 2979, 1914, 3825, 3921, 589, 6841, 6608, 6525, 2653, 6578, 1145, 1111, 2793, 3836, 1875, 3396, 6070, 3679, 3152, 4563, 2562, 6416, 7508, 680, 949, 6778, 2524, 7355, 1419, 507, 4112, 5726, 3713, 2484, 586, 1500, 6328, 1771, 2971, 4535, 1244, 4885, 3260, 3252, 2147, 1689, 6814, 2487, 1626, 3857, 3492, 6281, 2423, 3102, 3615, 6749, 7275, 5362, 6211, 6435, 722, 255, 7494, 4841, 345, 1088, 6107, 5649, 993, 977, 1347, 1923, 7378, 3772, 7186, 619, 342, 7538, 3330, 4900, 3981, 3670, 4031, 6241, 2613, 5772, 5542, 2408, 6424, 2550, 6955, 4416, 2214};
    int arr2[] = {2202, 5578, 405, 6153, 126, 5001, 2465, 196, 7427, 6927, 4545, 1330, 4814, 3238, 1119, 6258, 313, 4273, 414, 1238, 5680, 6099, 4752, 695, 5505, 6883, 934, 6132, 6324, 1188, 860, 6658, 3988, 441, 6429, 1144, 626, 1017, 5449, 1055, 7332, 210, 5160, 3550, 1890, 6501, 5462, 843, 838, 2705, 1415, 1756, 6270, 1913, 1291, 7115, 4997, 5703, 1705, 2800, 830, 4097, 6137, 6061, 4093, 1717, 7006, 908, 965, 7147, 4335, 5781, 7521, 6449, 5710, 6348, 4475, 7194, 4405, 2327, 3355, 2784, 1633, 2474, 181, 7252, 535, 2282, 5139, 2824, 7077, 1639, 6547, 2255, 5589, 717, 1435, 267, 6359, 3491, 5280, 995, 2079, 3724, 4932, 3925, 3317, 1171, 6712, 6604, 335, 3070, 5731, 6125, 62, 5034, 5487, 4490, 3356, 171, 5528, 3714, 4326, 2603, 2561, 130, 1303, 1186, 7131, 1659, 5638, 5006, 6796, 4549, 623, 1001, 3438, 1224, 2365, 5195, 1534, 4516, 2356, 6309, 876, 3147, 3134, 5230, 6181, 3866, 4985, 1816, 1685, 6829, 5438, 5974, 6808, 4631, 5705, 533, 5559, 1737, 4769, 6470, 4032, 5262, 6294, 5829, 3257, 5345, 4029, 6697, 1482, 640, 6123, 1230, 5210, 1293, 3856, 6322, 5632, 1023, 339, 4258, 6773, 660, 688, 2320, 1039, 5476, 2728, 4787, 4695, 6826, 3351, 5153, 548, 3733, 5027, 330, 1603, 6776, 3686, 503, 3541, 903, 4512, 6029, 5968, 2663, 5776, 3672, 4129, 981, 5939, 2384, 2448, 2160, 2012, 1483, 7527, 299, 2791, 222, 4552, 3665, 6261, 6466, 5404, 5078, 3617, 5964, 2199, 4773, 5595, 5387, 2082, 6143, 685, 5457, 4440, 1380, 1783, 4286, 1623, 4288, 5644, 4365, 5091, 1640, 3960, 639, 3998, 4355, 5683, 1733, 6920, 460, 6323, 854, 3464, 4287, 2385, 850, 6520, 5471, 7023, 4045, 3279, 6003, 263, 3595, 798, 4786, 861, 337, 7533, 492, 1569, 1009, 6710, 7423, 5654, 387, 3204, 3137, 5885, 756, 5970, 2843, 2213, 4232, 5800, 4390, 1707, 1179, 3403, 5530, 1759, 2687, 30, 57, 2763, 636, 651, 7334, 5323, 1878, 2493, 1340, 7523, 194, 6896, 5121, 2036, 2283, 6342, 1364, 7035, 3122, 2662, 7163, 6613, 2878, 2715, 3943, 5233, 6569, 4570, 1356, 513, 7089, 4238, 4763, 1990, 816, 3388, 465, 794, 6810, 6720, 4008, 7306, 435, 3308, 6733, 5026, 499, 4377, 2464, 2401, 4837, 5056, 3920, 4014, 7084, 6994, 324, 5947, 2495, 1060, 4499, 4804, 4649, 1219, 1541, 869, 2155, 2802, 5599, 1277, 4166, 309, 5062, 4996, 6791, 3383, 1604, 5773, 5248, 1994, 781, 3879, 1473, 7196, 3600, 2368, 3779, 5513, 6373, 1991, 353, 6755, 1472, 6249, 4560, 6664, 2860, 2722, 1871, 6735, 3681, 862, 1062, 1136, 3801, 6233, 4772, 386, 5059, 5173, 3221, 2340, 7493, 5794, 2884, 1341, 2335, 1063, 6483, 910, 3754, 1331, 6442, 6566, 6544, 7226, 7445, 43, 847, 5044, 2847, 3692, 261, 2567, 4344, 3357, 270, 6593, 3430, 6781, 1749, 864, 900, 192, 7062, 1384, 538, 6271, 3332, 6674, 1786, 4760, 5727, 6754, 6553, 17, 5294, 1629, 771, 1279, 1872, 7005, 5459, 3770, 3697, 612, 2110, 7027, 3893, 1800, 2584, 7118, 6606, 641, 2565, 5674, 649, 5217, 5851, 885, 4174, 4438, 341, 3362, 5347, 1050, 1785, 5562, 3458, 1388, 3591, 788, 6482, 397, 4546, 749, 1469, 1125, 7312, 2482, 7204, 2821, 6957, 243, 3660, 5053, 566, 4242, 1647, 6717, 4976, 91, 5598, 3605, 7037, 114, 3295, 4621, 5451, 4353, 5973, 5555, 5364, 5906, 5015, 7063, 5307, 5643, 7497, 2711, 6138, 1943, 5681, 262, 942, 3806, 2043, 6586, 6561, 1344, 4122, 5013, 1975, 7365, 6081, 3824, 1071, 4747, 2183, 1745, 6627, 4443, 2151, 5377, 6592, 2415, 2435, 4771, 4132, 1478, 5907, 1358, 6066, 3467, 6590, 2234, 783, 6418, 2249, 919, 3185, 939, 3614, 2372, 5780, 3716, 6035, 5052, 3493, 7485, 2529, 4551, 4564, 5235, 2849, 3032, 2175, 4249, 1590, 2911, 2286, 6000, 2288, 3756, 476, 7441, 1614, 2065, 6491, 4998, 5912, 4020, 2229, 1714, 2270, 6880, 2840, 3280, 1319, 997, 2004, 1398, 7057, 6101, 3781, 323, 3582, 3489, 3810, 5057, 182, 980, 583, 4984, 5863, 6898, 597, 4485, 690, 2400, 2783, 4157, 3065, 650, 6987, 5713, 4928, 7182, 1079, 3728, 3019, 4830, 2281, 4263, 1047, 5443, 3909, 3938, 144, 6330, 711, 3501, 950, 2296, 4178, 2235, 6331, 2460, 3506, 3429, 5045, 5066, 6083, 5741, 6459, 1906, 1772, 111, 5293, 5150, 404, 411, 4664, 3035, 4988, 3662, 5064, 4441, 3971, 1336, 5054, 4292, 3352, 5119, 7314, 5133, 3045, 868, 266, 5125, 1645, 4262, 1322, 5676, 2317, 6064, 5846, 2162, 5231, 5913, 1676, 6539, 6801, 4866, 5652, 2056, 1515, 246, 4311, 3642, 1945, 4931, 268, 6752, 6397, 5956, 518, 5817, 6516, 5030, 310, 1182, 3765, 456, 2228, 3311, 845, 4905, 5590, 5360, 1402, 5861, 7369, 2132, 145, 4962, 3063, 1455, 3166, 5267, 7105, 6876, 1139, 5319, 4670, 2075, 2343, 7250, 120, 6321, 2503, 7024, 1955, 4682, 5305, 750, 6545, 153, 7214, 7070, 3835, 5455, 3918, 5420, 2995, 5163, 6044, 5397, 3883, 3574, 675, 6882, 7388, 5630, 831, 5730, 6891, 694, 1527, 1984, 109, 4801, 3994, 3849, 2034, 1606, 321, 5324, 3066, 147, 3509, 5825, 2991, 5352, 4333, 865, 3108, 3062, 3006, 6305, 2370, 6836, 6287, 5648, 5613, 7141, 3175, 7452, 1873, 3903, 2537, 4562, 833, 4829, 2909, 3511, 1428, 4216, 2134, 925, 3915, 7340, 4596, 4349, 2409, 2430, 3233, 155, 3261, 4230, 7415, 5836, 5762, 6349, 1272, 4940, 6746, 2744, 3881, 4961, 6178, 2047, 6611, 5936, 7146, 3975, 6163, 6597, 1949, 3669, 2262, 3447, 7489, 1021, 5442, 3997, 4118, 3299, 6140, 3399, 4425, 3428, 2825, 3530, 4308, 886, 4789, 2499, 6091, 1971, 457, 2221, 2887, 4955, 5477, 2018, 1246, 4033, 4506, 6008, 7093, 7165, 2813, 7429, 6507, 458, 6948, 7110, 6148, 1690, 319, 1505, 7301, 401, 4616, 3473, 1389, 1183, 4316, 5141, 1826, 4872, 4399, 6643, 2006, 3807, 2979, 1914, 3825, 3921, 589, 6841, 6608, 6525, 2653, 6578, 1145, 1111, 2793, 3836, 1875, 3396, 6070, 3679, 3152, 4563, 2562, 6416, 7508, 680, 949, 6778, 2524, 7355, 1419, 507, 4112, 5726, 3713, 2484, 586, 1500, 6328, 1771, 2971, 4535, 1244, 4885, 3260, 3252, 2147, 1689, 6814, 2487, 1626, 3857, 3492, 6281, 2423, 3102, 3615, 6749, 7275, 5362, 6211, 6435, 722, 255, 7494, 4841, 345, 1088, 6107, 5649, 993, 977, 1347, 1923, 7378, 3772, 7186, 619, 342, 7538, 3330, 4900, 3981, 3670, 4031, 6241, 2613, 5772, 5542, 2408, 6424, 2550, 6955, 4416, 2214};
    // The test case wonâ€™t be shown here due to a large number of elements in an array, it will be shown in the appendix.
    int n1 = (int)sizeof(arr1) / (int)sizeof(int);
    int n2 = (int)sizeof(arr2) / (int)sizeof(int);    
    int k;
    printf("Enter k to find k-th smallest element in an array > ");
    scanf("%d",&k);
    startL = clock();
    int ans = quickSelect(arr1,0,n1-1,k,1);
    endL = clock();
    double time_lomuto = (double)(endL-startL) / (double)(CLOCKS_PER_SEC);
    printf("the k(%d)-th smallest element in the array (LOMUTO PARTITIONING) is %d || Time taken = %.10lf\n",k,ans,time_lomuto);

    startH = clock();
    int ans2 = quickSelect(arr2,0,n2-1,k,2);
    endH = clock();
    double time_hoare = (double)(endH-startH) / (double)(CLOCKS_PER_SEC);
    printf("the k(%d)-th smallest element in the array (HOARE PARTITIONING) is %d || Time Taken = %.10lf\n",k,ans2,time_hoare);
    return 0;
}